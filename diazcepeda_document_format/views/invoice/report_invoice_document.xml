<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!--Informe-->
    <record id="account_invoices_preprinted" model="ir.actions.report">
            <field name="name">Factura PreImpresa</field>
            <field name="model">account.move</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">diazcepeda_document_format.report_invoice_pre_printed</field>
            <field name="report_file">diazcepeda_document_format.report_invoice_pre_printed</field>
            <field name="print_report_name">(object._get_report_base_filename())</field>
            <field name="attachment"/>
            <field name="binding_model_id" ref="account.model_account_move"/>
            <field name="binding_type">report</field>
    </record>
    <!--Fin Informe -->
      <template id="report_invoice_pre_printed">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-set="lang" t-value="o.partner_id.lang"/>
                    <t t-set="is_preprinted" t-value="2"/>
                    <t t-if="o._get_name_invoice_report() == 'account.report_invoice_document'"
                       t-call="account.report_invoice_document"
                       t-lang="lang"/>
                </t>
            </t>
        </template>

    <!-- Documento -->
    <template id="report_saleorder_document_inherit" inherit_id="account.report_invoice_document">
        <xpath expr="//th[@name='th_priceunit']" position="replace">
            <th name="th_priceunit" t-attf-class="text-end {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Precio</span></th>
        </xpath>

        <xpath expr="//td[@name='td_quantity']" position="replace">
            <td name="td_quantity" class="text-end">
                <span t-field="line.quantity">3</span>
            </td>
        </xpath>

        <xpath expr="//t[@t-set='lines']" position="replace">
            <t t-set="lines" t-value="o._get_invoice_lines_to_report(o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True))"/>
        </xpath>

         <xpath expr="//div[@t-if='not is_html_empty(o.narration)']" position="after">
             <t t-set="show_gastos_gestion" t-value="o._is_gasto_gestion()"/>
             <t t-if = "show_gastos_gestion">
                 <span>Gastos de gestión 1€</span>
             </t>
        </xpath>

         <xpath expr="//td[@name='account_invoice_line_name']" position="inside">
            <br/>
             <span><i> • Lot </i></span>
             <t t-set="lot_values" t-value="o._get_invoiced_lot_values()"/>
              <t t-foreach="lot_values" t-as="snln_line">
                 <span><i><t t-esc="snln_line['lot_name']"/></i></span>
                 <span>(</span>
                 <span><i><t t-esc="snln_line['quantity']"/></i></span>
                 <span>)</span>
              </t>
        </xpath>
    </template>


     <template id="stock_account_report_invoice_document_inherit" inherit_id="account.report_invoice_document">
        <xpath expr="//table[@name='invoice_snln_table']" position="attributes">
            <attribute name="style">display: none;</attribute>
        </xpath>
    </template>
</odoo>
